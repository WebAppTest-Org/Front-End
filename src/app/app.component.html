<div class="container mt-5">
  <!-- Outer border -->
  <div class="border p-4">
    <h1 style="text-align: center;">Registration Form</h1>
<form [formGroup]="myForm">
    <label class="d-block mb-1"><strong>Name</strong></label>

  <mat-form-field appearance="outline" class="w-100">
    <input matInput formControlName="name" placeholder="Enter your name" />
    <!-- Error messages -->
    <mat-error *ngIf="myForm.get('name')?.hasError('required')">
       Required
    </mat-error>
    <mat-error *ngIf="myForm.get('name')?.hasError('minlength')">
      Minimum 4 characters required
    </mat-error>
  </mat-form-field>
<br>
    <label class="d-block mb-1"><strong>Email</strong></label>

<mat-form-field appearance="outline" class="w-100">
  <input matInput type="email" formControlName="email" placeholder="Enter your email" />

  <!-- Validation errors -->
  <mat-error *ngIf="myForm.get('email')?.hasError('required') && myForm.get('email')?.touched">
    Email is required
  </mat-error>
  <mat-error *ngIf="myForm.get('email')?.hasError('email') && myForm.get('email')?.touched">
    Please enter a valid email address
  </mat-error>
</mat-form-field>
<br>
    <label class="d-block mb-1"><strong>Country</strong></label>
    <mat-form-field appearance="outline" class="mt-3">
    <mat-select formControlName="country" placeholder="Select Country" >
      <mat-option value="USA">USA</mat-option>
      <mat-option value="UK">UK</mat-option>
      <mat-option value="Asia">Asia</mat-option>
    </mat-select>
    <!-- Validation error -->
    <mat-error *ngIf="myForm.get('country')?.hasError('required')">
      Required
    </mat-error>
  </mat-form-field>

    <div class="mt-3">
    <label class="d-block mb-1"><strong>Gender</strong></label>
    <mat-radio-group formControlName="gender">
      <mat-radio-button value="M" class="me-3">Male</mat-radio-button>
      <mat-radio-button value="F">Female</mat-radio-button>
      <mat-radio-button value="O">Others</mat-radio-button>
    </mat-radio-group>

    <!-- Validation error -->
    <mat-error *ngIf="submitted&&myForm.get('gender')?.hasError('required')">
           Required
    </mat-error>
  </div>
<br>
    <label class="d-block mb-1"><strong>University</strong></label>

 <mat-form-field appearance="outline" class="w-100">
    <input type="text" 
           matInput 
           formControlName="university"
           placeholder="Enter University"
           [matAutocomplete]="auto">

    <mat-autocomplete #auto="matAutocomplete">
      <mat-option *ngFor="let university of filteredUniversities | async" [value]="university">
        {{ university }}
      </mat-option>
    </mat-autocomplete>

    <mat-error *ngIf="myForm.get('university')?.hasError('required')">
      University is required
    </mat-error>
  </mat-form-field>
<br>
    <label class="d-block mb-1"><strong>Skills</strong></label>
<mat-form-field appearance="outline" class="w-100">

  <mat-select formControlName="skills" multiple placeholder="Select one or more skills">
    <mat-option *ngFor="let skill of skillsList" [value]="skill">
    
        {{ skill }}

    </mat-option>
  </mat-select>

  <mat-error *ngIf="myForm.get('skills')?.hasError('required') && myForm.get('skills')?.touched">
    At least one skill must be selected
  </mat-error>
</mat-form-field>
<br>
    <label class="d-block mb-1"><strong>Image</strong></label>
<mat-form-field appearance="outline" class="w-100">
  <!-- Hidden file input -->
  <input 
    type="file" 
    hidden 
     accept=".png, .jpeg" 
     multiple   
    (change)="onFilesSelected($event)" 
    #fileInput
  />
  <!-- Readonly text field to show filename -->
  <input 
    matInput 
 [value]="fileNames"  
    placeholder="Upload Image" 
    readonly 
    formControlName="file"
  />
  <!-- Button to trigger file input -->
  <button 
    mat-icon-button 
    matSuffix 
    type="button" 
    (click)="fileInput.click()">
    <mat-icon>attach_file</mat-icon>
  </button>
  <!-- Validation error -->
  <mat-error *ngIf="myForm.get('file')?.hasError('required') && myForm.get('file')?.touched">
    File is required
  </mat-error>
</mat-form-field>
<div *ngIf="selectedFiles.length > 0" class="mt-2">
  <mat-list>
    <mat-list-item *ngFor="let file of selectedFiles; let i = index">
      {{ file.name }}
      <button mat-icon-button color="warn" (click)="removeFile(i)">
        <mat-icon>close</mat-icon>
      </button>
    </mat-list-item>
  </mat-list>
</div>
<br>
<mat-checkbox formControlName="agree">
  I agree above information is true 
</mat-checkbox>
 <mat-error *ngIf="myForm.get('agree')?.hasError('required') && submitted">
         Required
  </mat-error>
<br>

  <button mat-raised-button color="primary" type="submit" (click)="openConfirmDialog()">
    Submit
  </button>
    <div *ngIf="getsubject$|async as user">
    {{user.name}}

  </div>
</form>
  </div>

</div>
<!-- Dialog Template -->
<ng-template #confirmDialog>
  <h2 mat-dialog-title>Confirm Submission</h2>
  <mat-dialog-content>
    Are you sure you want to submit?
  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button mat-button (click)="closeDialog(false)">No</button>
    <button mat-raised-button color="primary" (click)="closeDialog(true)">Yes</button>
  </mat-dialog-actions>
</ng-template>
